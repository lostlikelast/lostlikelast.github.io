<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HELLO，AMAP!</title>
    <style>
        html,
        body{
            width: 1920px;
            height: 1080px;
        }
        #container {
            width: 424px;
            height: 315px;
            position: relative;
        }
        .custom-content-marker {
            position: relative;
            width: 25px;
            height: 34px;
        }

        .custom-content-marker img {
            width: 100%;
            height: 100%;
        }

        .custom-content-marker .close-btn {
            position: absolute;
            top: -6px;
            right: -8px;
            width: 15px;
            height: 15px;
            font-size: 12px;
            background: #ccc;
            border-radius: 50%;
            color: #fff;
            text-align: center;
            line-height: 15px;
            box-shadow: -1px 1px 1px rgba(10, 10, 10, .2);
        }
        .my-panel{
            position: absolute;
            top: 0;
            left: 0;
            width: 150px;
        }
    </style>
</head>
<body>
<div id="container"></div>
<div id="my-panel" class="my-panel"></div>
</body>
<!--<script type="text/javascript">-->
<!--    window._AMapSecurityConfig = {-->
<!--        securityJsCode: "86992dd17045295f4e90d71ca775fc73",-->
<!--    };-->
<!--</script>-->
<script src="https://webapi.amap.com/loader.js"></script>
<script type="text/javascript">
    var getDrivingLine = function (AMap,map) {
        const startLngLat = [118.764172, 31.979453] //起始点坐标
        const endLngLat = [118.76444, 31.978904] //终点坐标
        AMap.plugin("AMap.Driving", function () {
            var driving = new AMap.Driving({
                //驾车路线规划策略，0是速度优先的策略
                policy: 0,
                //map 指定将路线规划方案绘制到对应的 AMap.Map 对象上
                map: map,
                //panel 指定将结构化的路线详情数据显示的对应的 DOM 上，传入值需是 DOM 的 ID
                panel: "my-panel",
            });
            var points = [
                { keyword: "北京市地震局（公交站）", city: "北京" },
                { keyword: "亦庄文化园（地铁站）", city: "北京" },
            ];
            //搜索完成后，将自动绘制路线到地图上
            driving.search(startLngLat,endLngLat);
        });
        return;
        AMap.plugin(["AMap.Driving"], function () {
            const driving = new AMap.Driving({
                map: map,
                panel: "my-panel",
            });
            //获取起终点规划线路
            driving.search(startLngLat, endLngLat, function (status, result) {
                if (status === "complete") {
                    //status：complete 表示查询成功，no_data 为查询无结果，error 代表查询错误
                    //查询成功时，result 即为对应的驾车导航信息
                    console.log(result);
                } else {
                    console.log("获取驾车数据失败：" + result);
                }
            });
        });
        //引入和创建驾车规划插件
        // AMap.plugin(["AMap.Driving"], function () {
        //     const driving = new AMap.Driving({
        //         map: map,
        //         panel: "my-panel",
        //     });
        //     //获取起终点规划线路
        //     driving.search(startLngLat, endLngLat, function (status, result) {
        //         if (status === "complete") {
        //             //status：complete 表示查询成功，no_data 为查询无结果，error 代表查询错误
        //             //查询成功时，result 即为对应的驾车导航信息
        //             console.log(result);
        //         } else {
        //             console.log("获取驾车数据失败：" + result);
        //         }
        //     });
        // });
    };
    AMapLoader.load({
        key: "1ed9e4a8d6cfbdf8ede6bbf6db792f25", //申请好的Web端开发者 Key，调用 load 时必填
        version: "2.0", //指定要加载的 JS API 的版本，缺省时默认为 1.4.15
    })
        .then((AMap) => {
            // const map = new AMap.Map("container");
            const map = new AMap.Map("container", {
                viewMode: "2D", //默认使用 2D 模式
                zoom: 15, //地图级别
                center: [118.764172,31.979453], //地图中心点
            });
            //点标记显示内容
            const markerContent = `<div class="custom-content-marker">
            <img src="//a.amap.com/jsapi_demos/static/demo-center/icons/dir-via-marker.png">
            </div>`
            const position = new AMap.LngLat(118.764172,31.979453); //Marker 经纬度
            const marker = new AMap.Marker({
                position: position,
                content: markerContent, //将 html 传给 content
                offset: new AMap.Pixel(-13, -30), //以 icon 的 [center bottom] 为原点
            });
            map.add(marker);
            const points = [
                { keyword: '南京市雨花台区雨花客厅',city:'南京' }, //起始点坐标
                { keyword: '"南京市雨花台区雨花客厅9栋2F-22A',city:'南京' } //终点坐标
            ]
            getDrivingLine(AMap,map);
        })
        .catch((e) => {
            console.error(e); //加载错误提示
        });
</script>
</html>